import { expect, describe, it } from '@jest/globals';
import { getZipData, getZipFromUrl } from '../../utils';

describe('test getZipData', function () {
    it('should return null if zip file is not valid', async () => {
        const zipData = getZipData(Buffer.from('invalid zip file'));
        expect(zipData).toBeNull();
    });
    it('should return valid data if zip file is valid', async () => {
        const binaryData: Buffer = Buffer.from(
            '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',
            'base64',
        );
        const [name, repository, version] = getZipData(binaryData) || ['', '', ''];
        expect(name).toBe('smallest');
        expect(repository).toBe('https://github.com/bendrucker/smallest');
        expect(version).toBe('1.0.1');
    });
});

describe('test getZipFromUrl', function () {
    it('should return valid data if url is valid', async () => {
        const url = 'https://github.com/bendrucker/smallest';
        const binaryData = await getZipFromUrl(url);
    });
});
